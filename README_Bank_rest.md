# Система управления банковскими картами

## Предисловие

Данная работа отражает полный функционал по работе с банковской системой. Основными контроллерами являются 
AdminController и PolzovatelController, в данном случае я намеренно заменил User на Polzovztel в данном контроллере,
поскольку наименование User часто конфликтует и выдает ошибки связанные с возможным зарезервированным неймингом.

Миграция данных Liquibase была реализована и все оптимально работает.

Также в работе имеются дополнительные контроллеры такие как DopCardController и DopUserController, они не были указаны
в качестве технического задания, но они также имеют обширный функционал по взаимодействию с Card и User.
Поэтому было принято решение их оставить для показания всех возможностей приложения, хотя повторюсь, это было не обязательно.

В связи с нехваткой времени к сожалению реализовать тесты не успел. Знаний для их реализации у меня имеется,
т.к. не первый раз покрывал приложения unit-тестами и интеграционными тестами с использованием библиотеки Mockito
и соответствующими ему mock-объектами. При необходимо могу также предоставить проекты с реализованным тестированием, для 
показа компетенции в этом вопросе. В данном случае повторюсь времени на их реализацию не хватило.

С таким функционалом как Spring Security не стану лукавить, работать не доводилось, но и данный функционал
был бы реализован, повторюсь время.

### Основной функционал
- Создание и управление картами
- Просмотр карт
- Осуществление переводов между картами

### Возможности
#### Администратор
- Создает, блокирует, активирует, удаляет карты
- Управление пользователями
- Видит все карты
#### Пользователь
- Просматривает свои карты
- Запрашивает блокировку карты
- Осуществляет переводы между картами
- Смотрит баланс

### API
- CRUD для карт
- Переводы между своими картами
- Выдача
- Сообщения об ошибке в случае таковых

### Работа с БД
- Использовалась реляционная база данных PostgreSQL
- Миграция осуществлялась через Liquibase

### Документация 
- README.md также была реализована

### Контейнеризация
- За счет использования Docker

## Инструкция по запуску приложения

### Основные команды AdminController
| Метод | URL               | Описание                              |
|-------|-------------------|-------------------------------------|
| GET   | /administrator    | Получить весь перечень карт          |
| POST   | /administrator | Создание карт(при наличии пользователя) |
| PUT   | /administrator/1  | Блокирование карты(при наличии запроса от пользователя)       |

### Основные команды PolzovatelController
| Метод | URL               | Описание                              |
|-------|-------------------|-------------------------------------|
| GET   | /polzovatel/{id}    | Получить перечень своих карт          |
| GET   | /polzovatel/balance/{id} | Предоставляет баланс карты пользователю |
| POST   | /polzovatel  | Создание пользователя       |
| PUT   | /polzovatel  | Осуществление перевода денежных средств       |
| GET  | /polzovatel/callBlockCard/{id}     | Создание запроса на блокировку карты            |

### Архитектура проекта
**Controllers**
- AdminController - осуществляет функционал доступный Администратору
- PolzovatelController - осуществляет функционал доступный Пользователю

Доп контроллеры(в случае необходимого расширения функционала приложения)
- DopCardController
- DopUserController

**Services**
- CardCRUDService - функционал для взаимодействия с картами пользователей
- UserCRUDService - функционал для взаимодействия с пользователями

**Entity** - JPA-сущности

**Repositories** - Spring Data репозитории для каждой сущности

### Алгоритм работы с приложением
1. Осуществляется создание пользователя(авторизация) за счет Post-запроса
/polzovatel
2. Осуществляется создание необходимого количества кард для пользователя
за счет Post-запроса /administrator
3. При необходимости Администратор также может просмотреть все созданные карты
за счет Get-запроса /administrator
4. Пользователь также может просмотреть все свои карты за счет Get-запроса
/polzovatel/1
5. Пользователь также может просмотреть баланс каждой карты используя 
Get-запрос /balance/{id}
6. При необходимости пользователь может осуществлять переводы денежных средств
используя Put-запрос /polzovatel
7. Если пользователь посчитал нужным заблокировать определенную карту
используется Get-запрос /polzovatel/callBlockCard/{id} в результате чего
создается соответствующий запрос для администратора.
8. Администратор может осуществить блокировку карты при помощи
Put-запроса /administrator/{id}, при условии если пользователь
составил запрос на ее блокировку. Заблокированные карты не могут участвовать
в денежных переводах.

Номера созданных карт и время их работы осуществляются случайным образом,
при создании каждой карты она автоматически активируется и получает
соответствующий статус.

### Введение данных
#### Polzovatel Create: Post-запрос /polzovatel
{

"nameUser": "Vladimir"

}

#### Admin Create card: Post-запрос /administrator
{

"name": "Vladimir",

"balance": 250,

"userId": 1

}

#### Admin Get All Cards: 
Get-запрос /administrator

#### Polzovatel Get Cards:
Get-запрос /polzovatel/1

#### Polzovatel Get Balance:
Get-запрос /polzovatel/balance/{id}

#### Polzovatel Transaction value:
Put-запрос /polzovatel

#### Polzovatel Call Block card:
Get-запрос /polzovatel/callBlockCard/{id}

#### Admin Block Card:
Put-запрос /administrator/{id}

